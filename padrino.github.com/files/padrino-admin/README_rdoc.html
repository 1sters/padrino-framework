<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>README.rdoc</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <table border='0' cellpadding='0' cellspacing='0' width="100%" class='banner'>
      <tr><td>
        <table width="100%" border='0' cellpadding='0' cellspacing='0'><tr>
          <td class="file-title" colspan="2"><span class="file-title-prefix">File</span><br />README.rdoc</td>
          <td align="right">
            <table border='0' cellspacing="0" cellpadding="2">
              <tr>
                <td>Path:</td>
                <td>padrino-admin/README.rdoc</td>
              </tr>
              <tr>
                <td>Modified:</td>
                <td>Wed Feb 03 00:24:53 +0100 2010</td>
              </tr>
            </table>
          </td></tr>
        </table>
      </td></tr>
    </table><br />

    <div id="bodyContent">
        <div id="content">
    
    <div class="description"><h1>Admin Dashboard and Authentication (padrino-admin)</h1>
<h3>Overview</h3>
<p>
<a href="../../classes/Padrino.html">Padrino</a> has a beautiful Ajax
Admin, with these fatures:
</p>
<table>
<tr><td valign="top">Orm Agnostic:</td><td>Adapters for datamapper, activerecord, mongomapper, couchdb (now only:
datamapper and activerecord)

</td></tr>
<tr><td valign="top">Authentication:</td><td>Support for Account authentication, Account Permission managment

</td></tr>
<tr><td valign="top">Scaffold:</td><td>You can simply create a new &#8220;admin interface&#8221; simply providing
a Model

</td></tr>
<tr><td valign="top">Ajax Uploads:</td><td>You can upload file, manage them and attach them to any model in a quick
and simple way (coming soon)

</td></tr>
</table>
<h3>Admin Usage</h3>
<p>
Create a project:
</p>
<pre>
  $ padrino-gen app fun-test
  $ cd fun-test
</pre>
<p>
For create the admin application:
</p>
<pre>
  fun-test$ padrino-gen admin
</pre>
<p>
Now follow admin instructions so:
</p>
<ul>
<li>edit your config/database.rb

</li>
<li>run padrino rake dm:auto:migrate

</li>
<li>run padrino rake seed

</li>
</ul>
<p>
Your admin now is &#8220;complete&#8221;, you can start your server with
<tt>padrino start</tt> and point your browser to /admin!
</p>
<p>
For create a new &#8220;scaffold&#8221; you need to provide only a Model
for them like:
</p>
<pre>
  fun-test$ padrino-gen model post --skip-migration // edit your post.rb model and add some fields
  fun-test$ padrino-gen rake dm:auto:migrate
  fun-test$ padrino-gen admin_page Post
  fun-test$ padrino start // and go to yourserver.local/admin
</pre>
<p>
That&#8217;s all!!
</p>
<h3>Admin Authentication</h3>
<p>
<a href="../../classes/Padrino.html">Padrino</a> Admin use a model Account
for manage role, membership and permissions take the following example:
</p>
<pre>
  access_control.roles_for :any do |role|
    role.allow &quot;/sessions&quot;
    # role.deny &quot;/deny/this/always&quot;
  end

  access_control.roles_for :admin do |role, account|
    role.allow &quot;/&quot;

    role.project_module :accounts do |project|
      project.menu :list, &quot;/admin/accounts.js&quot;
      project.menu :new,  &quot;/admin/accounts/new&quot;
    end
  end

  access_control.roles_for :editor do |role, account|
    role.project_module :posts do |project|
      project.menu :list, &quot;/admin/posts.js&quot;
      project.menu :new,  &quot;/admin/posts/new&quot;
    end

    role.project_module :comments do |project|
      project.menu :list, &quot;/admin/comments.js&quot;
      project.menu :new,  &quot;/admin/comments/new&quot;
    end
  end
</pre>
<p>
In this example we <tt>grant</tt> &#8220;/session&#8221; (and each subpaths
like /sessions/new) for all users logged and unlogged.
</p>
<p>
Account with role <tt>admin</tt> can manage <tt>only</tt> accounts because
have access to &#8220;/admin/accounts/**&#8221; paths Account with role
<tt>editor</tt> can manage <tt>only</tt> post/comments because have access
to &#8220;/admin/posts/**&#8221;, &#8220;/admin/posts/**&#8221; paths
</p>
<p>
Another good fature of <a href="../../classes/Padrino.html">Padrino</a>
admin is that when you define a <tt>Project Module</tt> role you also build
the Menu Tree of the Admin. Trust us that in future you appreciate so much
this feature.
</p>
<h3>Admin Uploads</h3>
<p>
<a href="../../classes/Padrino.html">Padrino</a> admin has a builtin upload
managment that leave you to be free as possible.
</p>
<pre>
  fun-test$ padrino-gen admin_uploader
  fun-test$ rake dm:auto:upgrade # or ar:migrate
</pre>
<p>
Finish! Now you can browse into your admin and you can see a new menu
called <tt>upload</tt> where you can see all your uploads, upload other
file, delete &#8230;
</p>
<p>
All upload definitions are defined in lib/uploader.rb, here you can
preproces your attachments (like resize) or manage versions.
</p>
<p>
See <a
href="http://github.com/jnicklas/carrierwave">github.com/jnicklas/carrierwave</a>
</p>
<h4>Attach Many Uploads to a Model</h4>
<p>
If you want attach in a model ex: Account many uploads you can do that in a
simple way add a habtm relation!
</p>
<pre>
  # app/models/account.rb
  has n, :uploads
</pre>
<p>
or for ActiveRecord
</p>
<pre>
  # app/models/account.rb
  has_and_belongs_to_many :uploads
</pre>
<p>
Now edit the form and add these lines:
</p>
<pre>
  # admin/views/accounts/_form.haml
  %tr
    %td=f.label :uploads
    %td=f.open_window_grid :upload_ids, :with =&gt; :uploads, :get =&gt; :id, :show =&gt; :file, :multiple =&gt; true, :item =&gt; :panel
</pre>
<p>
<b>open_window_grid</b> is a padrino-admin method that open an extjs window
contains your <tt>grids</tt> so in this case:
</p>
<p>
open window grid for :<tt>account</tt> model in method :<tt>upload_ids</tt>
with the help of controller :<tt>uploads</tt> and get as a value the
:<tt>id</tt> and display :<tt>file</tt>.
</p>
<p>
:<tt>multiple</tt> indicate that we need more than one :<tt>id</tt>.
:<tt>item</tt> tell to the grid who is the container, we need to explicit
this because we have two container in our upload.js
</p>
<p>
See view <a
href="http://github.com/padrino/padrino-framework/blob/master/padrino-admin/lib/padrino-admin/helpers/view.rb#L145">helpers</a>
for more docs.
</p>
<p>
That&#8217;s all! Now run mingrations and browse accounts for see our
uploader.
</p>
<h4>Attach One Upload to a Model</h4>
<p>
The process is the same as above you need only define in your model:
</p>
<pre>
  # app/models/account.rb
  belongs_to :upload
</pre>
<p>
and add this to your account form:
</p>
<pre>
  # admin/views/accounts/_form.haml
  %tr
    %td=f.label :upload
    %td=f.open_window_grid :upload_id, :with =&gt; :uploads, :get =&gt; :id, :show =&gt; :file, :item =&gt; :panel
</pre>
<p>
Remember to run migrations before start your server.
</p>
<h2>Copyright</h2>
<p>
Copyright &#169; 2010 <a href="../../classes/Padrino.html">Padrino</a>. See
LICENSE for details.
</p>
</div>
    

    

    
    

    
    

    

    

    

    

    

    
</div>
    </div>
  </body>
</html>
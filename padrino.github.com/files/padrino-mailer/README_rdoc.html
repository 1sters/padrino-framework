<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>README.rdoc</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <table border='0' cellpadding='0' cellspacing='0' width="100%" class='banner'>
      <tr><td>
        <table width="100%" border='0' cellpadding='0' cellspacing='0'><tr>
          <td class="file-title" colspan="2"><span class="file-title-prefix">File</span><br />README.rdoc</td>
          <td align="right">
            <table border='0' cellspacing="0" cellpadding="2">
              <tr>
                <td>Path:</td>
                <td>padrino-mailer/README.rdoc</td>
              </tr>
              <tr>
                <td>Modified:</td>
                <td>Wed Feb 03 00:24:53 +0100 2010</td>
              </tr>
            </table>
          </td></tr>
        </table>
      </td></tr>
    </table><br />

    <div id="bodyContent">
        <div id="content">
    
    <div class="description"><h1>Simple Mailer Support (padrino-mailer)</h1>
<h3>Overview</h3>
<p>
This component uses an enhanced version of the excellent <tt>pony</tt>
library (vendored) for a powerful but simple mailer system within <a
href="../../classes/Padrino.html">Padrino</a> (and Sinatra). There is full
support for using an html content type as well as for file attachments. The
MailerPlugin has many similarities to ActionMailer but is much
lighterweight and (arguably) easier to use.
</p>
<h3>Usage</h3>
<p>
Let&#8217;s take a look at using the MailerPlugin in an application. By
default, MailerPlugin uses the built-in sendmail functionality on the
server. However, smtp is also supported using the following configuration:
</p>
<pre>
    Padrino::Mailer::Base.smtp_settings = {
      :host   =&gt; 'smtp.gmail.com',
      :port   =&gt; '587',
      :tls    =&gt; true,
      :user   =&gt; 'user',
      :pass   =&gt; 'pass',
      :auth   =&gt; :plain
   }
</pre>
<p>
Once those have been defined, the default will become smtp delivery unless
overwritten in an individual mail definition. Next, we should define a
custom mailer extended from <tt>Padrino::Mailer::Base</tt>.
</p>
<pre>
  # app/mailers/sample_mailer.rb
  class SampleMailer &lt; Padrino::Mailer::Base
    def registration_email(name, user_email_address)
      from 'admin@site.com'
      to user_email_address
      subject 'Welcome to the site!'
      body    :name =&gt; name
      type    'html'                # optional, defaults to plain/text
      charset 'windows-1252'        # optional, defaults to utf-8
      via     :sendmail             # optional, to smtp if defined otherwise sendmail
    end
  end
</pre>
<p>
This defines a mail called &#8216;<tt>registration_mail</tt>&#8217; with
the specified attributes for delivery. The <tt>body</tt> method is passing
the <tt>name</tt> attribute to the body message template which should be
defined in <tt>[views_path]/sample_mailer/registration_email.erb</tt> as
shown below:
</p>
<pre>
  # ./views/sample_mailer/registration_email.erb
  This is the body of the email and can access the &lt;%= name %&gt; that was passed in from the mailer definition
  That's all there is to defining the body of the email which can be plain text or html
</pre>
<p>
Once the mailer definition has been completed and the template has been
defined, the email can be sent using:
</p>
<pre>
  SampleMailer.deliver(:registration_email, &quot;Bob&quot;, &quot;bob@bobby.com&quot;)
</pre>
<p>
or if you like the method_missing approach:
</p>
<pre>
  SampleMailer.deliver_registration_email &quot;Bob&quot;, 'bob@bobby.com'
</pre>
<p>
And that will then deliver the email according the the configured options.
This is really all you need to send emails. A few variations are shown
below for completeness.
</p>
<p>
If we want to attach files to our email:
</p>
<pre>
  # app/mailers/sample_mailer.rb
  class SampleMailer &lt; Padrino::Mailer::Base
    def attachment_email(name, user_email_address)
      from 'admin@site.com'
      to user_email_address
      # ...
      attachments { &quot;foo.zip&quot; =&gt; File.read(&quot;path/to/foo.zip&quot;), &quot;file.txt&quot; =&gt; &quot;this is a text file!&quot; }
    end
  end
</pre>
<p>
or perhaps we want to have a short body without the need for a template
file:
</p>
<pre>
  # app/mailers/sample_mailer.rb
  class SampleMailer &lt; Padrino::Mailer::Base
    def short_email(name, user_email_address)
      from 'admin@site.com'
      to user_email_address
      subject 'Welcome to the site!'
      body    &quot;This is a short body defined right in the mailer itself&quot;
    end
  end
</pre>
<p>
See the wiki article for additional information: <&#8230;WIKI&#8230;>
</p>
<h2>Copyright</h2>
<p>
Copyright &#169; 2010 <a href="../../classes/Padrino.html">Padrino</a>. See
LICENSE for details.
</p>
</div>
    

    

    
    

    
    

    

    

    

    

    

    
</div>
    </div>
  </body>
</html>